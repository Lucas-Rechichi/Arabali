{% extends 'main/template.html' %}
{% load crispy_forms_tags %}
{% block title %} Feed {% endblock %}
{% block topsidebar %}
<li class="custom-icon"><div class="fs-4"><i class="bi bi-person" style="color: #787878;"></i></div> <a href="/profile/{{username}}" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Profile</p></a></li>
{% endblock %}
{% block middlesidebar %}
<li class="custom-icon"><div class="fs-4"><i class="bi bi-gear-wide-connected" style="color: #787878;"></i></div> <a href="/settings/{{username}}" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Settings</p></a></li>
{% endblock %}
{% block searchBar %}
{{search_bar|crispy}}
{% endblock %}
{% block body %}
<div class="modal fade show" id="LPModal" tabindex="-1" aria-hidden="false" aria-modal="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="LPModalTitle">Note</h5>
            </div>
            <div class="modal-body">
                <p class="lead text-center"> To be able to optimise the algorithum to show you the best of your the people that you follow, location permissions must be allowed. </p>
                <p class="text-center"><strong> If you deside not to allow permisssions, this page is still accessible.</strong></p>
            </div>
            <div class="modal-footer">
                <button id="allowedLP" type="button" class="btn btn-success">Allow</button>
                <button id="deniedLP" type="button" class="btn btn-outline-success" data-bs-dismiss="modal">Deny</button>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () { 
        var LPModal = new bootstrap.Modal(document.getElementById('LPModal'), {
            keyboard: false
        });
        LPModal.show();
    
        $('#allowedLP').click(function () {
            // Check if Geolocation is supported
            if (navigator.geolocation) {
                // Get the current position
                navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
            } else {
                $.ajax({
                    type: 'POST',
                    url: '/page/error/',
                    date: {
                        'issue': 'Geolocation API Not Supported On Your Browser',
                        'csrfmiddlewaretoken': '{{ csrf_token }}'
                    },
                })
            }
        

        // Success callback for geolocation
        function successCallback(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            
        }

        // Error callback for geolocation
        function errorCallback(error) {
            console.error('Error getting geolocation:', error);
            
        }
        });

    })
</script>
{% endblock %}