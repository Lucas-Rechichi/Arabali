{% load crispy_forms_tags %}
    <style>
        .heading{
    display: flex;
    margin: auto;
}
ul{
        list-style-type: none;
        padding-left: 40px;
}
    .custom-icon {
    position: relative;
    padding-left: 30px; /* Space for custom bullet */
}
    .custom-icon i {
    position: absolute;
    left: 0;
}
     .topbar{
     width: 100%;
     height: 85px;
     background-color: rgb(186, 186, 186);
 }
 .logo-button{
     background-color: rgb(186, 186, 186);
     border: none;
     size: 60px;
     padding-left: 30px;
     padding-top: 15px;
 }
 
 .contents{
     padding: 30px;
         width: 70%;
         height: 70%;
         margin: auto;
         position: absolute;
         top: 50%;
         margin-top: 20px;
         text-align: center;
 }
 .post{
     padding: 30px;
         width: 85%;
         height: 85%;
         margin: auto;
         position: absolute;
         top: 50%;
         margin-top: 20px;
         text-align: left;
 }
 .add{
     width: 10%;
     margin: auto;
     position: absolute;
 }
 .profile{
     text-align: center;
     padding: 10px;
     margin: auto;
     position: absolute;
     width: 85%;
     height: 85%;
     margin-top: 25px;
 }
 .like {
     width: 10%;
     height: 10%;
     margin-left: 90%;
 }
 .pfp_image{
     width: 30px;
     height: 30px;
     border-radius:15px;
 }
 .pfp_button{
     height: 35px;
     width: 35px;
     background-color: #fff;
     border-radius: 17.5px;
     border-color: green;
     display: flex;
     justify-content: center;
     align-items: center;
 }
 .follow{
     width: 100px;
     left: 50%;
     
 }
 .profile-row-one{
     text-align: center;
 }
 .profile-pfp{
     height: 100px;
     width: 100px;
 }
.sideopener{
    position: absolute;
    right: 10px;
    top: 20px;
}
.user-profile{
    position: absolute;
    height: 54px;
    width: 54px;
    right: 80px;
    top: 15px;
}
.user-image{
    position: absolute;
    right: 0px;
    bottom: 0px;
    height: 50px;
    width: 50px;
    border-radius: 25px;
}
.minipost{
    width: 300px;
    height: 100px;                          
}
.invis{
    border: none;
    background-color: #fff;

}
    </style>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For You | Arabali</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    </head>
<body>

<div class="topbar">
    <button type="button" class="logo-button" onclick='location.href = "/home/"'><h2 class="display-6" style="color: green;">Arabali</h2></button>
    <button class="btn sideopener" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasnav" aria-controls="offcanvasnav" style="height: 40px; width: fit-content;">
        <div class="fs-2"><i class="bi bi-list" style="color: #198754;"></i></div>
    </button>
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasnav" aria-labelledby="offcanvasnav">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasExampleLabel"><p class="lead">More</p></h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div>
                <div class="container">
                    <div class="row">
                        <div class="col-12 p-2">
                            <ul>
                                <li class="custom-icon"><div class="fs-4"><i class="bi bi-person" style="color: #787878;"></i></div> <a href="/profile/{{username}}" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Profile</p></a></li>
                                <li class="custom-icon"><div class="fs-4"><i class="bi bi-rss-fill" style="color: #787878;"></i></div> <a href="/page/" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Feed</p></a></li>
                                <li class="custom-icon"><div class="fs-4"><i class="bi bi-chat-text" style="color: #787878;"></i></div> <a href="" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Messages</p></a></li>
                                <li class="custom-icon"><div class="fs-4"><i class="bi bi-gear-wide-connected" style="color: #787878;"></i></div><a href="/settings/{{username}}" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Settings</p></a></li>
                                <li class="custom-icon"><div class="fs-4"><i class="bi bi-box-arrow-right" style="color: #787878;" ></i></div> <a href="/logout/" class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"><p class="lead">Logout</p></a></li>                       
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>  

<div class="container">
    <div class="row">
        <div class="col-4">
            <nav id="navbar-settings" class="h-100 flex-column align-items-stretch pe-4 border-end">
                <nav class="nav nav-pills flex-column">
                    <h6 class="display-6 text-center">Settings</h6>
                    <a href="#edit-profile" class="btn btn-outline-success d-block mb-2">Edit Profile</a>
                    <a href="#posts" class="btn btn-outline-success d-block">Posts</a>
                    <br>
                </nav>
            </nav>
        </div>
        <div class="col-8">
            <div data-bs-spy="scroll" data-bs-target="#navbar-settings" data-bs-smooth-scroll="true" class="scrollspy-example-2" tabindex="0">
                <div id="edit-profile">
                    <div class="card p-3" style="top:50px;">
                        <h2 class="display-4 text-center">Change Profile</h2>
                        <br>
                        <form id="EditProfileForm" method="post", enctype="multipart/form-data">
                            {% csrf_token %}
                            {{edit_profile_form | crispy}}
                            <input type="hidden" id="change" name="change" value="">
                            <button type="button" class="btn btn-light border border-success" id="EditProfile"><img src="/arabali_users/Images/App_Icons/Screenshot 2024-04-07 at 1.25.42 pm.png" alt="" style="height: 30px; width: 30px;"> Change</button>
                        </form>
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                document.getElementById('EditProfile').addEventListener('click', function() {
                                    document.getElementById('change').value = 'change';
                                    document.getElementById('EditProfileForm').submit();
                                });
                            });
                        </script>
                        <div class="row">
                            <div class="col text-center">
                                <p class="lead">Current Username: {{username}}</p>
                            </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col">
                                <p class="lead">Current Pfp:</p> <img src="{{user_stats.pfp.url}}" alt="" style="height: 100px; width: 100px;">
                            </div>
                            <div class="col">
                                <p class="lead text-center">Current Banner:</p> <img src="{{user_stats.banner.url}}" alt="" style="width: 400px; height: 100px">
                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>        
                    <br>
                </div>
            </div>
            <div id="posts">
                <div class="card p-3" style="top:50px;">
                    <div class="container">
                        <div class="row">
                            <div class="col-3 mt-2 d-inline-flex justify-content-center">
                                <button class="btn btn-light add border border-success" onclick='location.href = "/add/"'><img src="/arabali_users/Images/App_Icons/Screenshot 2024-04-07 at 8.38.03 am.png" alt="" style="height: 30px; width: 30px;"></button>
                            </div>
                            <div class="col ms-5">
                                <h2 class="display-4">Manage Posts</h2>
                            </div>
                        </div>
                        <div class="row">
                            {% for posts in post %}
                                <div class="modal fade" id="post-{{posts.id}}" aria-hidden="true">
                                    <div class="modal-dialog" style="max-width: 56%;">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                Post
                                                <button class="btn btn-close" data-bs-dismiss="modal"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container">
                                                    <div class="row">
                                                        <div class="col">
                                                            <h6 class="display-6">{{posts.title}}</h6>
                                                        </div>
                                                    </div>
                                                    <hr>
                                                    <br>
                                                    <div class="row">
                                                        <div class="col">
                                                            <img class="" src="{{posts.media.url}}" alt="" style="height: 250px; width: 100%;">
                                                        </div>
                                                    </div>
                                                    <br>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="lead">{{posts.contents}}</p>
                                                        </div>
                                                    </div>
                                                <br>
                                                <div class="row">
                                                    <div class="col">
                                                        <p class="lead">Likes: {{posts.likes}}</p>
                                                        <p class="lead">Post ID: {{posts.id}}</p>
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#ConfirmDelete-{{posts.id}}" >Delete Post</button>
                                                    </div>
                                                    <div class="col">
                                                        <p class="lead">Date Created: {{posts.created_at}}</p>
                                                        {% if posts.date_modified %}
                                                        <p class="lead">Date Modified: {{posts.date_modified}}</p>
                                                        {% else %}
                                                        <p class="lead">Date Modified: Hasen't Been Modified.</p>
                                                        {% endif %}
                                                        <button class="btn btn-outline-success" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#EditPost-{{posts.id}}">
                                                            Edit Post
                                                        </button>
                                                    </div>
                                                    <div class="col">
                                                        <a class="btn btn-outline-success" data-bs-toggle="collapse" href="#satisfied-users-{{ posts.id }}" role="button" aria-expanded="false" aria-controls="satisfied-users-{{ posts.id }}">
                                                            Liked By
                                                        </a>
                                                        <div id="satisfied-users-{{ posts.id }}" class="collapse alert alert-success mt-3">
                                                            <ul>
                                                                {% for likedby in posts.liked_by.all %}
                                                                    <li>{{ likedby }}</li>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </div>
                                <div class="modal fade" id="ConfirmDelete-{{posts.id}}" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <Strong>Warning</Strong>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container">
                                                    <div class="row">
                                                        <div class="col">
                                                            <p>Are you sure you want to delete this post?</p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6 d-inline-flex justify-content-center">
                                                            <form id="DeleteForm" method="post">
                                                                {% csrf_token %}
                                                                <input type="hidden" id="delete" name="delete" value="">
                                                                <input type="hidden" id="posts_id" name="posts_id" value="">
                                                                <button type="button" id="DeletePost" class="btn btn-danger">Delete Post</button>
                                                            </form>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    document.getElementById('DeletePost').addEventListener('click', function() {
                                                                        document.getElementById('delete').value = 'delete';
                                                                        document.getElementById('posts_id').value = '{{posts.id}}';
                                                                        document.getElementById('DeleteForm').submit();
                                                                    });
                                                                });
                                                            </script>
                                                        </div>
                                                        <div class="col-6 d-inline-flex justify-content-center">
                                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal fade" id="EditPost-{{posts.id}}" aria-hidden="true">
                                    <div class="modal-dialog" style="max-width: auto;">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                Edit Post
                                            </div>
                                            <div class="modal-body">
                                                <div class="container">
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <form action="" method="post" enctype="multipart/form-data" id="EditPostForm">
                                                                {% csrf_token %}
                                                                {{edit_post_form | crispy}}
                                                                <input type="hidden" id="confirm" name="confirm" value="">
                                                                <input type="hidden" id="post-id" name="post-id" value="">
                                                                <button type="submit" class="btn btn-success" id="EditPostButton" name="EditPostButton" value="">Confirm</button>
                                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                            </form>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    document.getElementById('EditPostButton').addEventListener('click', function() {
                                                                        document.getElementById('confirm').value = 'confirm';
                                                                        document.getElementById('post-id').value = '{{posts.id}}';
                                                                        document.getElementById('EditPostForm').submit();
                                                                    });
                                                                });
                                                            </script>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="lead">Current Titie: {{posts.title}}</p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <p class="lead">Current Content:</p> {{posts.contents}}
                                                        </div>
                                                    </div>
                                                    <br>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p class="lead">Current Media:</p><img src="{{posts.media.url}}" alt="Media for {{posts.title}} Post" style="width: 400px; height: 100px">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#post-{{posts.id}}">{{ posts.title }}</button>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>  
    </div>
</div>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

        </body>
        </html>